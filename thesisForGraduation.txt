基于多智能体架构的校园舆情监测与情感分析系统的设计与实现

【格式说明：论文题目，黑体小二号居中，行距固定值28磅】


摘  要

【格式说明：摘要标题，黑体小二号居中】
【格式说明：摘要正文，宋体小四号，行距20磅，首行缩进2字符】

随着移动互联网的深入发展和社交媒体平台的日趋普及，高校学生在微博、知乎、B站、抖音等网络空间中的表达日益活跃，由此产生的校园网络舆情已成为影响校园安全稳定和学生心理健康的重要因素。传统的人工巡查方式受限于信息量庞大、时效性不足和覆盖范围有限等问题，难以满足新时期高校舆情管理的实际需求。因此，如何借助人工智能技术实现对校园网络舆情的自动化采集、智能化分析和精准化预警，具有较强的现实意义和应用价值。

本文针对当前高校舆情管理中存在的数据来源分散、分析手段单一、预警响应滞后等问题，设计并实现了一套基于多智能体协作架构的校园舆情监测与情感分析系统。系统采用前后端分离的B/S架构，后端基于FastAPI框架构建RESTful API服务，前端使用React框架搭建可视化交互界面。在核心算法层面，系统引入了LangChain框架和DeepSeek大语言模型，通过构建情感分析Agent、主题聚类Agent、风险评估Agent、审核决策Agent、知识检索Agent和报告生成Agent共六个专业化智能体，利用LangGraph状态图引擎实现多智能体的有序协作。在数据采集方面，系统对接了微博热搜、知乎热榜、B站热搜等12个主流平台的公开数据接口，采用两阶段采集管道实现热点发现与话题提取。在情感分析方面，系统设计了抽象基类统一模型接口，并实现了多模型加权集成投票机制以提高预测稳健性。此外，系统还整合了基于ChromaDB向量数据库的检索增强生成技术、基于LangGraph的风险预警工作流、人工审核闭环管理以及MCP协议的外部AI工具集成能力。

测试结果表明，系统能够有效完成多平台舆情数据的实时采集、情感倾向的准确判别、心理风险的自动评估以及预警信息的及时推送，各功能模块运行稳定，基本满足高校辅导员和学生管理人员的日常舆情管理需求。

关键词：校园舆情监测；情感分析；多智能体系统；大语言模型；LangGraph；检索增强生成

【格式说明：关键词，宋体小四号加粗标注"关键词："，内容宋体小四号，各词间用分号分隔】


Abstract

【格式说明：英文摘要标题，Times New Roman小二号加粗居中】
【格式说明：英文摘要正文，Times New Roman小四号，行距20磅】

With the rapid development of mobile Internet and the increasing popularity of social media platforms, college students have become highly active in expressing their opinions on platforms such as Weibo, Zhihu, Bilibili, and Douyin. The resulting campus online public opinion has become a significant factor affecting campus safety and students' mental health. Traditional manual monitoring methods are constrained by the massive volume of information, insufficient timeliness, and limited coverage, making it difficult to meet the practical needs of campus opinion management in the new era. Therefore, leveraging artificial intelligence technologies to achieve automated collection, intelligent analysis, and precise early warning of campus online public opinion holds strong practical significance and application value.

This thesis addresses the problems of scattered data sources, limited analytical methods, and delayed early warning responses that exist in current campus opinion management. A campus public opinion monitoring and sentiment analysis system based on a multi-agent collaborative architecture has been designed and implemented. The system adopts a B/S architecture with separated front-end and back-end. The back-end is built upon the FastAPI framework to provide RESTful API services, while the front-end utilizes the React framework to construct a visual interactive interface. At the core algorithm level, the system introduces the LangChain framework and the DeepSeek large language model, constructing six specialized agents including SentimentAgent, TopicAgent, RiskAgent, ReviewDecisionAgent, KnowledgeAgent, and ReportAgent, and employs the LangGraph state graph engine to coordinate multi-agent collaboration. For data collection, the system interfaces with public data APIs from 12 mainstream platforms including Weibo Trending, Zhihu Hot List, and Bilibili Hot Search, utilizing a two-stage collection pipeline for hot topic discovery and keyword extraction. For sentiment analysis, the system designs an abstract base class to unify model interfaces and implements a weighted ensemble voting mechanism across multiple models to enhance prediction robustness. Furthermore, the system integrates Retrieval-Augmented Generation based on the ChromaDB vector database, a LangGraph-based risk alert workflow, a closed-loop manual review management system, and external AI tool integration capabilities through the MCP protocol.

Testing results demonstrate that the system can effectively accomplish real-time collection of multi-platform opinion data, accurate sentiment classification, automatic psychological risk assessment, and timely early warning notification. All functional modules operate stably and fundamentally meet the daily opinion management requirements of college counselors and student affairs administrators.

Keywords: Campus Public Opinion Monitoring; Sentiment Analysis; Multi-Agent System; Large Language Model; LangGraph; Retrieval-Augmented Generation

【格式说明：英文关键词，Times New Roman小四号加粗标注"Keywords:"，内容首字母大写，分号分隔】


目  录

【格式说明：目录标题，黑体小二号居中；目录项由Word自动生成，宋体小四号】

摘  要
Abstract
第一章  绪论 .............................................................. 1
  1.1  研究背景与意义 .................................................... 1
  1.2  国内外研究现状 .................................................... 3
    1.2.1  舆情监测技术研究现状 ........................................... 3
    1.2.2  情感分析技术研究现状 ........................................... 4
    1.2.3  多智能体系统研究现状 ........................................... 5
  1.3  研究内容与主要工作 ................................................ 6
  1.4  论文组织结构 ...................................................... 7
第二章  相关技术与理论基础 ................................................ 8
  2.1  大语言模型与LangChain框架 ......................................... 8
  2.2  多智能体协作与LangGraph状态图 ..................................... 9
  2.3  情感分析技术 ..................................................... 10
  2.4  检索增强生成技术 ................................................. 11
  2.5  FastAPI与React前后端分离架构 ..................................... 12
  2.6  本章小结 ......................................................... 13
第三章  系统需求分析与总体设计 ........................................... 14
  3.1  需求分析 ......................................................... 14
    3.1.1  功能性需求 .................................................... 14
    3.1.2  非功能性需求 .................................................. 16
  3.2  系统总体架构设计 ................................................. 17
  3.3  多智能体协作架构设计 ............................................. 18
  3.4  数据库设计 ....................................................... 20
  3.5  接口设计 ......................................................... 22
  3.6  本章小结 ......................................................... 23
第四章  系统详细设计与实现 ............................................... 24
  4.1  数据采集模块的设计与实现 ......................................... 24
  4.2  情感分析模块的设计与实现 ......................................... 27
  4.3  多智能体协作模块的设计与实现 ..................................... 30
  4.4  风险预警工作流的设计与实现 ....................................... 33
  4.5  人工审核模块的设计与实现 ......................................... 35
  4.6  知识检索与RAG模块的设计与实现 .................................... 37
  4.7  前端可视化模块的设计与实现 ....................................... 39
  4.8  本章小结 ......................................................... 42
第五章  系统测试与结果分析 ............................................... 43
  5.1  测试环境 ......................................................... 43
  5.2  功能测试 ......................................................... 43
  5.3  性能测试 ......................................................... 47
  5.4  测试结果分析 ..................................................... 49
  5.5  本章小结 ......................................................... 50
第六章  总结与展望 ....................................................... 51
  6.1  工作总结 ......................................................... 51
  6.2  不足与展望 ....................................................... 52
参考文献 ................................................................ 53
致  谢 .................................................................. 56


第一章  绪论

【格式说明：章标题，黑体小二号居中，段前24磅段后18磅】

1.1  研究背景与意义

【格式说明：节标题，黑体小三号，段前18磅段后12磅】
【格式说明：正文，宋体小四号，行距20磅，首行缩进2字符】

近年来，伴随我国互联网基础设施的持续完善和智能移动终端的广泛普及，网络社交平台已经深度嵌入当代大学生的日常生活之中。中国互联网络信息中心(CNNIC)发布的第53次《中国互联网络发展状况统计报告》显示，截至2024年6月，我国网民规模已达10.9967亿人，互联网普及率为78.0%，其中10至29岁年龄段的网民占比达到23.4%[1]。大学生群体作为数字原住民的典型代表，在微博、知乎、B站、抖音、百度贴吧等社交媒体上的信息交互行为极为频繁，其发布的言论和观点在短时间内即可形成规模化传播，部分涉及校园管理、教学质量、食堂服务、宿舍条件、就业压力和心理健康等敏感话题的内容一旦引发广泛关注，便有可能演变为影响校园安全稳定的舆情事件。

校园舆情是指围绕高校内部事务或与高校师生密切相关的社会事务而形成的网络舆论态势。与一般社会舆情相比，校园舆情在传播特征上呈现出主体集中度高、情绪感染性强、扩散速度快和话题周期短等特点。教育部在2021年印发的《关于加强新时代学生心理健康教育工作的通知》中明确要求，高校应建立健全学生心理危机预警和干预机制，充分运用信息化手段提升心理健康教育工作的精准性和时效性[2]。在此政策背景下，构建一套面向校园场景的智能舆情监测系统不仅有助于高校管理部门及时感知学生群体的思想动态和情感诉求，也有利于在负面舆情初期阶段就进行有效的干预和引导。

然而，当前高校舆情管理工作仍然面临着诸多实际困难。首先，学生的网络表达分散在众多不同的社交平台上，缺乏统一的信息汇聚渠道。辅导员在日常工作中通常只能通过人工浏览部分网站或依赖学生的主动反馈来了解舆情动态，信息获取的覆盖面十分有限。其次，面对海量的网络文本数据，依靠人工方式逐条阅读和判断其情感倾向及风险程度既不现实也不高效，容易产生遗漏和误判。再者，传统的舆情管理流程在时效性上存在明显不足，从发现问题到做出响应往往要经历较长的决策链条，难以满足网络舆情快速发酵的应对需要。

与此同时，人工智能技术特别是自然语言处理领域近年来取得了显著进展。以GPT系列和DeepSeek为代表的大语言模型（Large Language Model, LLM）在文本理解、情感识别和内容生成等任务上展现出了接近甚至超越人类的能力[3]。LangChain作为面向大语言模型应用开发的开源框架，通过提供工具调用、链式调用和智能体等抽象层，大幅降低了构建复杂AI应用的技术门槛[4]。LangGraph在此基础上进一步引入了有向图形式的工作流编排机制，使得多个智能体之间的协作调度和状态传递变得更加灵活和可控[5]。这些技术的成熟为解决上述校园舆情管理难题提供了新的思路和方法。

基于以上分析，本文的研究目标是设计并实现一套基于多智能体协作架构的校园舆情监测与情感分析系统，该系统旨在通过整合多平台数据采集、智能情感分析、自动风险评估、知识库辅助决策和人工审核闭环管理等功能，为高校辅导员和学生管理人员提供一个集监测、分析、预警和处置于一体的智能化工作平台。本研究的意义主要体现在以下几个方面：

第一，在理论层面，本研究探索了多智能体协作范式在校园舆情分析场景中的应用模式，通过设计协调者Agent调度多个专业化子Agent的工作机制，为基于大语言模型的复杂分析任务提供了一种可参考的架构方案。

第二，在技术层面，本研究实现了LangChain工具链、LangGraph状态图、多模型集成投票和检索增强生成等多项技术在同一系统中的融合应用，在工程实践中验证了这些技术组合的可行性和有效性。

第三，在应用层面，本系统面向高校辅导员的实际工作场景设计，提供了从数据采集到分析预警再到审核处置的全流程支持，有助于提升高校舆情管理工作的效率和精准度。


1.2  国内外研究现状

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

1.2.1  舆情监测技术研究现状

【格式说明：条标题，黑体四号，段前12磅段后6磅】

网络舆情监测作为社会治理信息化的重要组成部分，一直是学术界和工业界关注的焦点方向。在国外的研究中，舆情监测研究较早地与社交媒体分析相结合。Pang和Lee在其开创性的综述工作中系统梳理了观点挖掘和情感分析的基本方法，为后续大量研究奠定了理论基础[6]。Liu的情感分析专著进一步完善了情感分析的技术框架，将问题划分为文档级、句子级和方面级三个层次[7]。近年来，随着深度学习技术的发展，基于Transformer架构的预训练模型如BERT[8]、RoBERTa[9]等被广泛应用于舆情监测中的文本分类和情感识别任务，显著提升了分析精度。在系统层面，Twitter（现X平台）的流数据API被大量研究者用于构建实时舆情监测原型系统，Bollen等人较早地利用Twitter数据分析公众情绪与股市波动的关联[10]。

在国内，网络舆情监测研究起步稍晚但发展迅速。刘毅在《网络舆情研究概论》中系统论述了网络舆情的概念、特征和监测方法[11]。随着微博、微信等国内社交平台的兴起，针对中文社交媒体的舆情监测研究逐渐增多。兰月新等提出了基于多源异构数据的网络舆情态势感知方法，实现了跨平台舆情数据的融合分析[12]。在工业界，人民网舆情数据中心、新浪微舆情等商业平台提供了面向政府和企业的舆情监测服务，但这些平台大多面向通用场景，对校园舆情这一细分领域的针对性不足。

在校园舆情监测的专项研究中，近年来已有部分学者开始关注将自然语言处理技术应用于高校舆情管理。周锐等针对高校网络舆情的特点，提出了融合情感分析和社会网络分析的舆情预警模型[13]。张斌等设计了面向高校微博数据的舆情分析系统，采用朴素贝叶斯和支持向量机进行情感分类[14]。然而，现有校园舆情监测系统在以下方面仍存在不足：一是数据采集渠道多局限于单一平台；二是分析方法以传统机器学习为主，对语义理解的深度有限；三是系统的预警和处置功能不够完善，缺乏从监测到干预的闭环设计。

1.2.2  情感分析技术研究现状

【格式说明：条标题，黑体四号，段前12磅段后6磅】

情感分析（Sentiment Analysis），也称为意见挖掘（Opinion Mining），是自然语言处理领域的一个重要研究方向，其核心任务是从文本中自动识别和提取主观信息。按照分析粒度的不同，情感分析可以分为文档级、句子级和方面级三个层次。

在技术方法的演进过程中，情感分析经历了从基于规则和词典的方法到基于传统机器学习的方法，再到基于深度学习方法的发展历程。早期的研究工作主要依赖于人工构建的情感词典来判断文本的情感极性，如Hu和Liu提出的基于语义关联的情感词典构建方法[15]。随后，以支持向量机（SVM）、朴素贝叶斯（NB）和最大熵等为代表的监督学习方法被引入情感分类任务，Pang等人的研究表明这些方法在电影评论情感分类上能够达到较高的准确率[6]。

深度学习时代的到来为情感分析带来了革命性的变化。Kim提出的TextCNN模型通过卷积操作捕捉文本中的局部语义特征，在多个情感分类基准数据集上取得了优异的效果[16]。循环神经网络及其变体LSTM和GRU则擅长建模文本的序列依赖关系，Tang等人提出的TD-LSTM模型将目标信息融入LSTM结构中，在方面级情感分析任务上表现突出[17]。2018年Google提出的BERT模型采用双向Transformer编码器进行大规模预训练，在情感分析等多项自然语言处理任务上刷新了当时的最佳记录[8]。

大语言模型的出现进一步拓展了情感分析的技术边界。与传统方法需要大量标注数据进行有监督训练不同，大语言模型凭借其在海量语料上习得的通用语言理解能力，可以通过零样本（zero-shot）或少样本（few-shot）的方式直接执行情感分析任务。Zhang等人的研究系统评估了ChatGPT在多种情感分析任务上的表现，发现其在多数场景下已接近甚至达到了经过微调的专用模型的水平[18]。DeepSeek-V2和DeepSeek-V3作为国产大语言模型的代表，在中文文本理解和分析任务上展现出了较强的竞争力[19]。这些进展为本文采用大语言模型作为情感分析的核心引擎提供了理论和实践依据。

1.2.3  多智能体系统研究现状

【格式说明：条标题，黑体四号，段前12磅段后6磅】

多智能体系统（Multi-Agent System, MAS）的研究可以追溯到分布式人工智能领域的早期工作。Wooldridge在其经典教材中将智能体定义为能够自主感知环境并采取行动以实现其目标的计算实体，多智能体系统则是由多个智能体通过交互和协作来解决单个智能体难以独立完成的复杂任务[20]。传统的多智能体系统主要关注通信协议、任务分配和冲突消解等问题，典型的应用场景包括机器人协作、分布式传感器网络和电子商务谈判等。

随着大语言模型的快速发展，基于LLM的多智能体系统成为人工智能研究的新热点。与传统多智能体系统不同，基于LLM的智能体具备更强的自然语言理解和推理能力，能够处理更加开放和复杂的任务。Park等人在2023年提出的生成式智能体（Generative Agents）研究中，展示了多个由LLM驱动的智能体在模拟小镇中自主交互和协作的能力，引发了学术界的广泛关注[21]。AutoGen框架将多智能体对话作为基本协作模式，允许开发者定义不同角色的智能体并通过多轮对话完成复杂任务[22]。CrewAI则提出了基于角色扮演的多智能体协作框架，通过定义Agent的角色、目标和工具来实现任务的分工和协作[23]。

LangGraph作为LangChain生态中的工作流编排组件，采用有向图的方式来定义智能体之间的协作拓扑和状态流转逻辑。与基于自由对话的协作模式相比，LangGraph的图结构化方法在流程的可控性和可解释性方面具有明显优势，特别适合需要明确执行顺序和条件分支的业务场景[5]。在实际应用中，已有研究者将基于LangGraph的多智能体架构应用于代码审查、医疗诊断辅助和金融风控等领域，但在校园舆情分析场景中的应用尚处于探索阶段。

本文在上述研究的基础上，将基于LangGraph的多智能体协作架构引入校园舆情分析领域，通过设计六个功能各异的专业化Agent，构建了一个从数据采集到分析预警的完整智能处理链路。


1.3  研究内容与主要工作

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

针对上述分析中指出的现有校园舆情管理工作面临的痛点，以及当前研究中存在的不足，本文围绕基于多智能体架构的校园舆情监测与情感分析系统的设计与实现展开研究。具体的研究内容和主要工作包括以下几个方面：

（1）多平台数据采集模块的设计与实现。针对校园舆情数据来源分散的问题，设计了覆盖微博热搜、知乎热榜、B站热搜、抖音热榜、百度贴吧、今日头条等12个主流平台的数据采集器。采集器通过调用公开的新闻数据接口，以异步并发的方式获取各平台的热点内容，并利用DeepSeek大语言模型从采集到的新闻中自动提取与校园相关的话题和搜索关键词，形成两阶段（热点发现—话题提取）的数据采集管道。

（2）基于大语言模型的情感分析模块的设计与实现。设计了以抽象基类统一模型接口的可扩展情感分析框架，当前注册了DeepSeek LLM直接推理模型和LangChain工具封装模型两个实例。在此基础上实现了多模型加权集成投票机制，通过对各模型预测结果进行加权概率融合来提高最终判断的稳健性。

（3）多智能体协作系统的设计与实现。基于LangGraph状态图引擎，设计了包含SentimentAgent、TopicAgent、RiskAgent、ReviewDecisionAgent、KnowledgeAgent和ReportAgent的六智能体协作工作流。CoordinatorAgent作为协调者负责初始化状态、调度子Agent的执行顺序、传递中间结果，并根据风险评估结果动态决定后续的处理路径（高风险触发知识检索，低风险直接生成报告）。

（4）风险预警与人工审核模块的设计与实现。风险评估Agent基于LLM对文本中的心理风险信号进行四级分类（低风险、中等风险、高风险、危急），并自动触发相应的预警和审核流程。人工审核模块实现了任务自动创建、按院系智能分配辅导员、优先级排序、审核操作和跟进反馈等完整的闭环管理功能。

（5）前端可视化界面的设计与实现。使用React框架构建了包含总览仪表板、舆情监测、情感分析、热点话题、预警中心、分析报告、系统设置和智能分析共8个功能页面的可视化管理平台，采用Recharts图表库实现数据的直观展示。


1.4  论文组织结构

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

本文共分为六章，各章的内容安排如下：

第一章为绪论，阐述了本文的研究背景和意义，分别从舆情监测技术、情感分析技术和多智能体系统三个角度梳理了国内外的研究现状，在此基础上提出了本文的研究内容和主要工作，并说明了论文的组织结构。

第二章为相关技术与理论基础，介绍了本系统开发所涉及的核心技术，包括大语言模型与LangChain框架、多智能体协作与LangGraph状态图、情感分析技术、检索增强生成技术以及FastAPI与React前后端分离架构。

第三章为系统需求分析与总体设计，首先从功能性需求和非功能性需求两个维度进行了系统的需求分析，然后分别阐述了系统的总体架构设计、多智能体协作架构设计、数据库设计和接口设计。

第四章为系统详细设计与实现，依次介绍了数据采集模块、情感分析模块、多智能体协作模块、风险预警工作流、人工审核模块、知识检索与RAG模块以及前端可视化模块的详细设计方案和关键实现代码。

第五章为系统测试与结果分析，描述了测试环境和测试方案，展示了功能测试和性能测试的结果，并对测试数据进行了分析和讨论。

第六章为总结与展望，总结了本文的研究工作和取得的成果，指出了系统目前存在的不足，并对未来的改进方向进行了展望。


第二章  相关技术与理论基础

【格式说明：章标题，黑体小二号居中，段前24磅段后18磅】

2.1  大语言模型与LangChain框架

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

大语言模型是指参数规模达到数十亿乃至数千亿级别的深度神经网络语言模型，其核心架构通常基于Vaswani等人在2017年提出的Transformer结构[24]。Transformer通过自注意力（Self-Attention）机制来建模输入序列中任意位置之间的依赖关系，相较于此前的循环神经网络架构，在并行计算效率和长距离依赖捕捉能力上具有显著优势。在此基础上，GPT系列模型采用仅解码器（Decoder-only）的架构，通过在大规模文本语料上进行自回归预训练，使模型习得了广泛的语言知识和推理能力[3]。

本系统选用DeepSeek作为主要的大语言模型。DeepSeek是由深度求索（DeepSeek AI）公司研发的开源大语言模型系列，其V2版本采用了混合专家（Mixture of Experts, MoE）架构，在保持推理效率的同时提升了模型容量[19]。DeepSeek在中文理解和生成任务上表现优异，特别是在情感分析、文本分类和摘要生成等本系统核心需求的相关任务上具备较强的能力。系统通过OpenAI兼容的API接口调用DeepSeek的推理服务，这一设计也使得系统在未来可以方便地切换到其他兼容该接口标准的大语言模型。

LangChain是一个面向大语言模型应用开发的开源框架，由Harrison Chase于2022年发起。该框架提供了一系列模块化的抽象层，包括模型接口（Models）、提示模板（Prompts）、链（Chains）、工具（Tools）、智能体（Agents）和记忆（Memory）等核心组件[4]。在本系统中，LangChain主要被用于以下几个方面：一是通过ChatPromptTemplate构建结构化的提示词模板，引导大语言模型按照预定的格式输出情感分析、主题聚类和风险评估等任务的结果；二是利用@tool装饰器将各分析功能封装为标准化的LangChain工具，便于智能体在执行过程中灵活调用；三是使用JsonOutputParser等输出解析器将大语言模型返回的非结构化文本转换为可被程序直接处理的JSON对象。


2.2  多智能体协作与LangGraph状态图

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

多智能体系统是由多个具有自主性的智能实体组成的分布式系统，各智能体通过交互和协作来完成单个智能体难以独立处理的复杂任务。在基于大语言模型的多智能体系统中，每个Agent通常被赋予特定的角色定位和专业能力，并配备相应的工具集，通过某种协调机制来实现任务的分解、分配和结果的整合。

LangGraph是LangChain生态体系中用于构建多步骤、多智能体工作流的核心组件。它采用有向图（Directed Graph）作为工作流的描述形式，图中的节点（Node）代表执行特定操作的处理单元（如某个Agent或某项计算任务），边（Edge）定义了节点之间的执行顺序和数据流转方向[5]。LangGraph的几个关键特性使其特别适合本系统的需求：

首先，LangGraph提供了类型化的状态定义机制。开发者可以使用Python的TypedDict来定义工作流的全局状态结构，所有节点共享并更新这一状态对象。在本系统中，MultiAgentState包含了输入文本、各Agent的分析结果、风险等级判定、审核建议和最终报告等信息字段，确保了数据在多个Agent之间的有序传递。

其次，LangGraph支持条件路由（Conditional Edges）。通过定义路由函数，系统可以根据运行时的状态值动态决定工作流的走向。本系统利用这一特性实现了根据风险评估结果选择不同处理路径的逻辑：当风险等级为高风险或危急时，工作流将额外触发知识检索Agent从向量知识库中检索相关的心理健康指导材料，以增强最终报告的专业性和针对性；而当风险等级较低时，则直接由报告生成Agent汇总现有分析结果并输出报告。

再次，LangGraph内置了执行日志记录能力。在本系统的实现中，每个Agent节点在执行前后都会向状态中的agent_logs列表追加包含Agent名称、执行动作、时间戳和执行状态等信息的日志条目，这些日志信息不仅便于开发阶段的调试，也被前端界面用于向用户展示多Agent协作的执行过程。


2.3  情感分析技术

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

情感分析的任务目标是从给定的文本中自动识别其所表达的情感倾向或情绪类别。在本系统中，情感分析需要解决的核心问题包括三个方面：一是判断文本的整体情感极性（正面、负面或中性）；二是识别文本中蕴含的细粒度情绪标签（如焦虑、愤怒、沮丧、欣喜等）；三是给出分析结果的置信度评估。

本系统采用基于大语言模型的提示工程方法来实现情感分析。与传统的监督学习方法不同，这种方法不需要预先准备大量标注数据集进行模型训练，而是通过精心设计的提示词来引导大语言模型利用其预训练阶段习得的语言理解能力直接给出分析结果。具体而言，系统向DeepSeek发送包含任务描述、输出格式要求和待分析文本的提示，要求模型返回包含sentiment（情感极性）、emotions（情绪标签列表）、confidence（置信度）和reasoning（判断理由）等字段的JSON格式结果。

为了进一步提高分析结果的可靠性，本系统设计了多模型集成投票机制。系统中注册了两个实现不同推理路径的分析模型：DeepSeekModel通过直接调用大语言模型进行端到端的情感分析，LangChainToolModel则通过LangChain的工具链（包含提示模板、模型调用和输出解析的完整链路）来完成分析。集成投票时，系统分别调用各个已注册模型对同一文本进行预测，然后将各模型的预测结果转换为正面概率值，按预设权重进行加权平均，最终根据融合后的概率值确定情感极性。这一机制的设计思路借鉴了集成学习中的加权投票策略，其核心假设是不同模型或推理路径在某些样本上可能产生不同的偏差，通过融合多个判断可以降低单一模型的随机误差。


2.4  检索增强生成技术

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

检索增强生成（Retrieval-Augmented Generation, RAG）是一种将信息检索与文本生成相结合的技术范式。其基本原理是在大语言模型执行生成任务之前，先从外部知识库中检索与当前查询相关的文档片段，将检索到的内容作为额外的上下文信息注入到提示词中，从而增强模型生成结果的事实准确性和领域专业性。Lewis等人在2020年首次提出RAG的概念框架，将其应用于开放域问答等任务并取得了显著的效果提升[25]。

在本系统中，RAG技术被应用于知识检索Agent的实现。当多智能体工作流中的风险评估结果达到高风险或危急等级时，KnowledgeAgent会被触发执行，它从向量知识库中检索与当前情感分析结果和风险信号相关的专业指导材料（如心理健康教育指南、危机干预手册等），并将检索结果传递给ReportAgent用于生成更加专业的分析报告和处置建议。

系统的向量知识库基于ChromaDB构建。ChromaDB是一个开源的嵌入式向量数据库，支持向量的高效存储和相似度检索。知识库的构建流程如下：首先，使用Python-docx和PyPDF等库解析TXT、PDF和DOCX格式的知识文档；然后，利用LangChain的RecursiveCharacterTextSplitter将长文档按照指定的块大小和重叠长度切分为文本段落；接着，调用HuggingFace提供的all-MiniLM-L6-v2预训练模型将文本段落编码为384维的稠密向量表示；最后将向量及其对应的原始文本存入ChromaDB。在检索阶段，系统将查询文本（由情绪标签和风险信号拼接而成）同样编码为向量，通过余弦相似度计算从知识库中检索出语义最相近的Top-K个文本段落作为参考资料。


2.5  FastAPI与React前后端分离架构

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

本系统采用前后端分离的B/S（Browser/Server）架构，后端和前端分别独立开发和部署，通过RESTful API进行数据交互。这种架构模式具有职责清晰、开发效率高、易于独立扩展等优点，是当前Web应用开发中的主流实践。

后端框架选用FastAPI。FastAPI是一个基于Python 3.6+类型提示的高性能Web框架，由Sebastián Ramírez于2018年创建。该框架基于Starlette和Pydantic构建，原生支持异步请求处理（async/await），在性能上接近Node.js和Go语言的Web框架[26]。FastAPI的几个特性使其特别适合本系统的技术需求：一是其自动生成交互式API文档（Swagger UI和ReDoc）的能力大幅方便了前后端的联调和测试；二是其基于Pydantic的请求/响应数据验证机制保障了接口的健壮性；三是其对异步编程的原生支持使得数据采集等IO密集型操作能够高效执行。系统后端使用Uvicorn作为ASGI服务器来运行FastAPI应用。

前端框架选用React。React是由Meta（原Facebook）开发和维护的开源JavaScript用户界面库，采用组件化和虚拟DOM的设计理念。本系统使用React 19版本，配合Vite 7作为构建工具。前端的路由管理使用React Router DOM实现8个页面之间的导航切换，数据可视化采用Recharts图表库绘制包括折线图、饼图、柱状图和词云在内的多种统计图表，HTTP请求通过Axios客户端库发送。前端界面设计遵循响应式布局原则，采用侧边栏导航加顶栏信息的页面结构，并支持深色主题模式。

在数据持久化层面，系统同时使用了MySQL关系型数据库和ChromaDB向量数据库。MySQL用于存储舆情记录、审核任务、预警信息和统计数据等结构化业务数据，通过SQLAlchemy ORM框架进行数据库操作；ChromaDB用于存储知识文档的向量表示，支撑检索增强生成功能。


2.6  本章小结

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

本章对系统开发所涉及的核心技术进行了介绍和分析。大语言模型和LangChain框架为系统的智能分析能力提供了基础支撑，LangGraph的状态图机制为多智能体的有序协作提供了流程编排工具，基于提示工程和多模型集成的方法为情感分析任务提供了有效的技术路径，检索增强生成技术为知识库辅助决策提供了实现手段，FastAPI和React的前后端分离架构为系统的工程化实现提供了成熟的框架支持。上述技术的合理组合构成了本系统的技术底座。


第三章  系统需求分析与总体设计

【格式说明：章标题，黑体小二号居中，段前24磅段后18磅】

3.1  需求分析

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

在系统的需求分析阶段，通过与多所高校的辅导员和学生工作管理人员进行访谈调研，结合对相关文献和现有系统的调查，从功能性需求和非功能性需求两个维度梳理了系统应满足的具体要求。

3.1.1  功能性需求

【格式说明：条标题，黑体四号，段前12磅段后6磅】

经过对用户需求的整理和归纳，本系统的功能性需求可划分为以下几个子系统：

（1）多平台数据采集子系统。该子系统需要能够从微博、知乎、B站、抖音、百度贴吧和今日头条等多个社交媒体平台获取与校园相关的舆情数据。采集过程应支持定时自动执行和手动触发两种模式。采集到的原始数据需要经过去重、清洗和标准化处理后存入数据库。此外，系统还需要具备从采集到的热点新闻中自动提取校园相关话题和搜索关键词的能力。

（2）智能情感分析子系统。该子系统需要对采集到的文本数据进行情感倾向分析，判断其为正面、负面或中性，同时提取细粒度的情绪标签并给出置信度评估。系统应支持单条文本分析和批量文本分析两种使用方式，并提供多模型集成投票功能以提高分析结果的可靠性。

（3）多智能体协作分析子系统。该子系统是本系统的核心功能模块。用户输入一段待分析的文本后，系统应依次调用情感分析Agent、主题聚类Agent、风险评估Agent和审核决策Agent对文本进行多维度的综合分析，对于高风险内容还需额外触发知识检索Agent，最终由报告生成Agent输出结构化的分析报告。多Agent的执行过程应支持日志记录和可视化展示。

（4）风险预警子系统。该子系统需要根据情感分析和风险评估的结果自动生成预警信息。预警信息应包含预警标题、风险等级、预警描述和AI建议的处置方案。管理人员可以对预警进行确认、处置和关闭等操作。预警统计信息应在仪表板页面直观展示。

（5）人工审核子系统。该子系统实现了人机协同的审核闭环。当系统检测到中等及以上风险的舆情内容时，应自动创建审核任务，按照发布者的院系信息将任务分配给对应的辅导员。辅导员可以查看任务详情、提交审核意见、修改风险等级判定，并在必要时将任务升级至更高级别的管理人员处理。

（6）数据可视化子系统。该子系统通过图形化的方式展示舆情监测和分析的结果。需要实现的可视化内容包括：关键指标概览（总记录数、情感分布、风险分布等）、情感趋势折线图、各平台声量统计、舆情词云、热点话题排行、预警统计以及各院系的舆情对比等。

（7）报告生成子系统。该子系统需要支持生成日报、周报和月报三种类型的常规报告，以及由AI根据数据自动生成的智能分析报告。报告内容应涵盖时段内的情感分布统计、风险情况汇总、热点话题分析和处置建议等信息。

（8）系统管理子系统。该子系统提供系统配置和参数管理功能，包括预警阈值设置、监测关键词管理、数据采集频率配置和通知推送设置等。

3.1.2  非功能性需求

【格式说明：条标题，黑体四号，段前12磅段后6磅】

除上述功能性需求外，系统还应满足以下非功能性需求：

（1）性能需求。系统应具备较好的响应速度，普通页面的加载时间不超过3秒，数据采集操作的超时阈值设为30秒。情感分析接口的单次请求响应时间应控制在合理范围内。系统应能支撑至少50个并发用户的正常使用。

（2）可靠性需求。系统应具备基本的容错处理能力，当外部数据源不可用或AI模型调用失败时，不应导致整个系统崩溃，而应给出合理的降级处理结果和错误提示信息。数据库操作应保证事务的原子性和一致性。

（3）可扩展性需求。系统的架构设计应便于后续功能的扩展。情感分析模块应支持新模型的注册接入，多智能体系统应支持新Agent的添加，数据采集模块应支持新平台的配置。技能系统（Skill）的设计应采用可插拔模式。

（4）安全性需求。系统应对涉及学生个人信息的数据进行脱敏处理，数据库中不存储学生的真实姓名和联系方式等敏感信息。接口访问应配置跨域资源共享（CORS）策略。

（5）可用性需求。前端界面应设计简洁明了，操作流程符合辅导员的日常工作习惯。各功能页面应提供必要的操作引导和状态反馈信息。


3.2  系统总体架构设计

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

基于上述需求分析，本系统采用分层架构进行总体设计，自下而上依次为数据存储层、业务逻辑层、接口服务层和表现层。

数据存储层包含MySQL关系型数据库和ChromaDB向量数据库。MySQL负责存储系统的核心业务数据，包括用户信息、舆情记录、审核任务、预警信息和统计数据等结构化数据。ChromaDB作为向量知识库，存储经过嵌入编码的心理健康知识文档，为检索增强生成功能提供底层支撑。两个数据库在系统中各司其职，互不干扰。

业务逻辑层是系统最为核心的部分，承载了全部的智能分析和业务处理能力。该层内部又可细分为四个子层：数据采集层（NewsCollector、TopicExtractor、CrawlerPipeline）负责从外部平台获取原始数据并进行预处理；情感分析层（BaseModel、DeepSeekModel、LangChainToolModel、SentimentPredictor）负责对文本进行情感倾向和情绪识别的分析；智能体协作层（CoordinatorAgent及六个子Agent）负责编排和执行多Agent协作的分析工作流；辅助功能层（ReviewAgent、ReportAgent、SkillRegistry、DashboardService）负责审核管理、报告生成、技能调度和数据聚合等支撑性功能。

接口服务层基于FastAPI框架构建，将业务逻辑层的各项能力以RESTful API的形式暴露给前端。该层包含了超过40个API端点，按功能划分为基础分析、多Agent协作、仪表板数据、审核管理、预警管理、数据采集、情感模型、报告生成、系统设置和MCP工具等多个接口组。此外，系统还通过MCP Server将核心分析能力以Model Context Protocol协议的形式暴露，使得Cursor和Claude Desktop等外部AI工具能够直接调用系统功能。

表现层即React前端应用，通过HTTP请求调用后端API获取数据，并以图表、表格、卡片等形式进行可视化展示，同时提供操作按钮和表单供用户执行审核、设置等交互操作。


3.3  多智能体协作架构设计

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

多智能体协作架构是本系统区别于传统舆情分析系统的核心设计。该架构将舆情分析这一复杂任务分解为情感分析、主题聚类、风险评估、审核决策、知识检索和报告生成六个子任务，分别由六个专业化的Agent负责执行，并由CoordinatorAgent统一调度和编排。

各Agent的职责分工如下：

（1）SentimentAgent（情感分析Agent）。接收输入文本，调用sentiment_analyzer工具进行情感分析，输出情感极性（positive/negative/neutral）、细粒度情绪标签列表和置信度评分。

（2）TopicAgent（主题聚类Agent）。在情感分析的基础上，调用topic_clusterer工具对文本进行主题分类。主题类别包括学业、人际关系、就业、心理健康、校园生活等，同时提取子话题标签和关键词。

（3）RiskAgent（风险评估Agent）。调用risk_screener工具对文本进行心理风险信号的识别和评级。风险等级分为低风险（low）、中等风险（medium）、高风险（high）和危急（critical）四级，同时输出风险信号列表和建议行动。该Agent的评估结果直接影响后续工作流的路由走向。

（4）ReviewDecisionAgent（审核决策Agent）。综合前三个Agent的分析结果，计算审核优先级（0-5分制），生成审核建议。优先级的计算规则为：危急风险对应5分，高风险对应4分，中等风险对应2分，低风险对应0分。该Agent还负责判定是否需要创建人工审核任务。

（5）KnowledgeAgent（知识检索Agent）。仅在风险等级为高风险或危急时被触发。该Agent根据情感分析中识别到的情绪标签和风险评估中发现的风险信号构建查询向量，从ChromaDB知识库中检索语义相关的专业指导材料。

（6）ReportAgent（报告生成Agent）。作为工作流的终端节点，汇总所有前序Agent的分析结果，调用大语言模型生成一份面向辅导员阅读的结构化综合分析报告，包含情况概述、风险评估和后续处理建议等内容。

上述六个Agent通过LangGraph StateGraph连接成一个有向无环图（DAG）工作流。工作流的执行顺序为：SentimentAgent → TopicAgent → RiskAgent → ReviewDecisionAgent → 条件路由 → [KnowledgeAgent] → ReportAgent → 结束。条件路由节点根据RiskAgent输出的风险等级决定后续路径：若为高风险或危急，则先经过KnowledgeAgent再到ReportAgent；否则直接到ReportAgent。整个工作流共享一个MultiAgentState类型的状态对象，各Agent在执行时读取所需的输入字段并写入自己的输出字段，实现了Agent之间的隐式通信。


3.4  数据库设计

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

本系统的关系型数据库包含5张核心数据表，分别是用户表（users）、情感分析记录表（sentiment_records）、审核任务表（review_tasks）、预警记录表（alerts）和分析统计表（analysis_stats）。以下分别介绍各表的设计。

（1）用户表（users）。存储辅导员和管理员的账户信息，主要字段包括：id（主键，自增整数）、username（用户名，唯一约束）、password_hash（密码哈希）、real_name（真实姓名）、role（角色，取值为admin或counselor）、department（所属院系）、phone（联系电话）、email（邮箱）和is_active（是否激活）。该表通过外键关联与审核任务表和预警表建立了一对多的关系。

（2）情感分析记录表（sentiment_records）。这是系统最核心的数据表，存储每一条舆情数据及其AI分析结果。表结构设计包含四组字段：原始数据字段（content、source、author_id、author_grade、author_department）用于记录文本内容和来源元信息；AI分析结果字段（sentiment、emotions、sentiment_confidence）用于存储情感分析的输出；主题分析字段（main_topic、sub_topics、keywords）用于存储主题聚类的结果；风险评估字段（risk_level、risk_indicators、risk_confidence、suggested_actions）用于存储风险评级信息。此外还有review_status和ai_summary两个审核相关字段。source字段使用枚举类型DataSource，取值包括weibo、wechat、forum、survey、counseling、feedback和other七种。该表在sentiment、risk_level、review_status、source、created_at、main_topic和author_department共7个字段上建立了索引，以优化查询性能。

（3）审核任务表（review_tasks）。记录每一项人工审核任务的信息。核心字段包括：record_id（关联的情感记录ID，外键）、reviewer_id（审核人ID，外键）、status（审核状态，枚举类型包括pending、approved、rejected、escalated和processing五种）、priority（优先级，0-5整数）、ai_risk_level（AI判定的风险等级）、reviewer_risk_level（审核人判定的风险等级）、review_comment（审核意见）、action_taken（已采取措施）、follow_up_required（是否需要跟进）和follow_up_note（跟进备注）。在status、priority和reviewer_id字段上建立了索引。

（4）预警记录表（alerts）。记录系统自动触发的风险预警及其处理过程。核心字段包括：record_id（关联的情感记录ID）、handler_id（处理人ID）、alert_type（预警类型，如risk、trend或anomaly）、risk_level（风险等级）、status（预警状态，枚举类型包括active、acknowledged、resolved和dismissed四种）、title（预警标题）、description（预警描述）、ai_suggestion（AI建议的处置方案）和handler_note（处理备注）。在status、risk_level和triggered_at字段上建立了索引。

（5）分析统计表（analysis_stats）。按天、周或月汇总情感分析和风险评估的统计数据，为仪表板的可视化展示提供数据支撑。包含情感分布统计（positive_count、negative_count、neutral_count）、风险分布统计（low_risk_count至critical_risk_count）、审核统计（pending_review_count、completed_review_count）以及热门话题和情绪的JSON汇总字段。

上述五张表通过外键约束形成了清晰的关联关系：sentiment_records表与review_tasks表为一对多关系（一条记录可产生多个审核任务），与alerts表同样为一对多关系；users表与review_tasks表为一对多关系（一个审核人可处理多个任务），与alerts表的handler关系也是一对多。


3.5  接口设计

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

系统后端共设计了十组RESTful API接口，覆盖了系统的全部功能模块。以下列出各组接口的主要设计：

（1）基础AI分析接口组。包含5个POST接口：/api/sentiment（情感分析）、/api/topic（主题聚类）、/api/risk（风险筛查）、/api/knowledge（知识库查询）和/api/analyze（综合分析）。这些接口接收包含text字段的JSON请求体，返回对应的分析结果。

（2）多Agent协作接口组。包含POST /api/multi-agent/analyze（触发多Agent协作分析）和GET /api/multi-agent/agents（获取Agent列表）两个接口。多Agent分析接口返回包含各Agent分析结果、执行日志和综合报告的完整响应。

（3）仪表板数据接口组。包含11个GET接口，分别提供总览数据、情感趋势、风险趋势、话题分布、情绪词云、院系统计、最近预警、数据来源分布、平台情感细表、最近舆情提及和话题详情等可视化所需的数据。这些接口通过DashboardService从数据库中聚合查询相关统计数据。

（4）审核管理接口组。包含GET /api/review/tasks（获取审核任务列表，支持按状态和优先级筛选）、POST /api/review/submit（提交审核结果）和GET /api/review/stats（获取审核统计）三个接口。

（5）预警管理接口组。包含GET /api/alerts（获取预警列表，支持分页和状态筛选）、GET /api/alerts/stats（预警统计）和POST /api/alerts/{id}/handle（处理指定预警，支持确认、解决和忽略三种操作）三个接口。

（6）数据采集接口组。包含GET /api/collector/status（采集器状态）、GET /api/collector/sources（支持的新闻源列表）、POST /api/collector/collect-news（触发新闻采集）、POST /api/collector/extract-topics（触发AI话题提取）和POST /api/collector/full-pipeline（运行完整采集管道，可选参数import_db控制是否入库）五个接口。

（7）情感分析模型接口组。包含POST /api/sentiment/analyze-batch（批量情感分析）、POST /api/sentiment/ensemble（集成投票预测）和GET /api/sentiment/models（获取已注册模型列表）三个接口。

（8）报告生成接口组。包含POST /api/reports/generate（生成基础报告）和POST /api/reports/generate-enhanced（生成增强报告，支持daily/weekly/monthly/ai四种类型）两个接口。

（9）系统设置接口组。包含GET /api/settings（获取当前系统设置）和POST /api/settings（保存系统设置）两个接口。

（10）MCP和Skill接口组。包含GET /api/skills（获取技能列表）、POST /api/skills/invoke（调用指定技能）、GET /api/mcp/tools（获取MCP工具列表）和POST /api/mcp/call（调用MCP工具）四个接口。


3.6  本章小结

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

本章从功能性需求和非功能性需求两个维度对系统进行了需求分析，在此基础上完成了系统的总体架构设计、多智能体协作架构设计、数据库设计和接口设计。系统采用分层架构，以FastAPI构建后端API服务，以React构建前端可视化界面，通过LangGraph编排六个专业化Agent的协作工作流，使用MySQL和ChromaDB分别存储结构化业务数据和向量化知识数据。上述设计方案为下一章的系统详细设计与实现奠定了基础。


第四章  系统详细设计与实现

【格式说明：章标题，黑体小二号居中，段前24磅段后18磅】

4.1  数据采集模块的设计与实现

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

数据采集模块是整个系统的数据入口，其职责是从多个社交媒体平台获取实时热点数据，并经过预处理后供后续的情感分析和智能体系统使用。该模块的设计采用了两阶段采集管道的架构思路，第一阶段完成热点新闻的多源并发采集，第二阶段利用大语言模型从新闻中提取校园相关话题和搜索关键词。

在热点新闻采集层面，系统实现了NewsCollector类作为核心采集器。该类封装了对公开新闻聚合API的异步HTTP调用逻辑。系统预先配置了12个新闻源，涵盖社交类（微博热搜）、问答类（知乎热榜）、视频类（B站热搜、抖音热榜）、新闻类（今日头条、澎湃新闻）、论坛类（百度贴吧）、科技类（酷安热榜、GitHub趋势）和财经类（华尔街见闻、财联社、雪球热榜）等多个类别。考虑到校园舆情的关联度差异，系统将微博、知乎、B站、抖音、贴吧和头条列为校园优先采集源，在默认模式下优先采集这些平台的数据。

NewsCollector的collect_news方法采用异步编程模式实现。对于每个新闻源，系统构造对应的API请求URL，通过httpx异步客户端发送GET请求并解析返回的JSON数据。为避免对数据源服务器造成过大压力，每次请求之间设置了0.3秒的礼貌延迟。对于请求超时或返回错误的新闻源，系统会记录警告日志但不影响其他源的正常采集。采集完成后，系统将所有成功获取的新闻条目汇总为统一格式的列表，每条记录包含唯一标识、标题文本、原始链接、来源平台和热度排名等字段，同时返回采集统计信息（总源数、成功源数、总新闻条数和采集时间戳）。

在话题提取层面，系统实现了TopicExtractor类。该类接收NewsCollector采集到的新闻列表作为输入，调用DeepSeek大语言模型从中提取与校园生活相关的话题和关键词。提取过程的具体实现是：将新闻标题按一定数量分批拼接后构造提示词，要求模型识别其中与大学生群体、校园管理、教育教学等方面相关的话题，并以JSON格式返回关键词列表和内容摘要。为提高输出解析的鲁棒性，系统对模型返回结果实现了正则匹配JSON的降级解析策略——当模型输出不符合严格的JSON格式时，尝试从返回文本中通过正则表达式提取JSON片段。TopicExtractor还提供了get_search_keywords方法，对提取出的关键词进行筛选和排序，生成用于后续深度采集的搜索关键词列表。

CrawlerPipeline类将上述两个组件串联为完整的数据采集管道。其run_full_pipeline方法依次执行新闻采集、话题提取和可选的数据库导入三个步骤。数据库导入功能通过import_news_to_database方法实现，该方法将采集到的新闻数据逐条转换为SentimentRecord对象并写入MySQL数据库，其中情感分析相关的字段暂时留空，等待后续的多智能体分析流程来填充。在数据源映射方面，系统根据新闻的来源平台标识自动匹配对应的DataSource枚举值，如weibo映射为WEIBO、zhihu和tieba映射为FORUM，其余平台统一映射为OTHER。

采集模块的API入口在FastAPI主程序中注册了5个端点。其中最核心的是POST /api/collector/full-pipeline接口，该接口接收一个可选的import_db布尔参数，当设置为true时，采集到的数据在完成话题提取后会自动导入数据库。辅导员在日常使用中只需每天调用一次该接口即可完成全部的数据更新工作。


4.2  情感分析模块的设计与实现

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

情感分析模块负责对文本内容进行情感倾向判别和情绪识别，是多智能体系统中SentimentAgent的底层能力支撑。该模块的设计遵循了面向对象的开放-封闭原则，通过抽象基类定义统一接口，具体模型实现可自由扩展。

模块的顶层抽象是BaseModel类，它定义了所有情感分析模型必须实现的两个核心方法：predict_single(text) 返回单条文本的预测标签和置信度元组，predict_batch(texts) 返回批量文本的预测结果列表。此外还提供了get_info方法用于返回模型的名称和加载状态等元信息。这一设计使得系统在添加新的分析模型时只需继承BaseModel并实现两个抽象方法即可，无需修改预测器或上层调用代码。

系统当前注册了两个具体的模型实现。第一个是DeepSeekModel，它直接调用DeepSeek大语言模型进行端到端的情感分析。该模型在predict_single方法中构造包含任务指令和输出格式要求的提示词，将待分析文本（截取前500字符以控制token消耗）拼接到提示末尾，调用LLM的invoke方法获取响应，然后通过正则表达式从返回文本中提取JSON格式的分析结果。模型采用了延迟加载策略——LLM实例仅在首次预测调用时才创建，避免了系统启动阶段的不必要开销。

第二个是LangChainToolModel，它封装了已有的LangChain情感分析工具（sentiment_analyzer）。该工具内部同样调用DeepSeek模型，但经过了LangChain的ChatPromptTemplate提示模板、LLM调用和JsonOutputParser输出解析的完整链路处理。与DeepSeekModel直接调用相比，LangChainToolModel的提示模板中包含了更详细的系统角色设定（"你是一个校园情感分析专家"）和输出字段的显式说明，并使用Pydantic数据模型来定义和验证输出结构，在输出规范性上更有保障。

SentimentPredictor类是对外暴露的统一预测器入口。它在构造函数中默认注册上述两个模型实例，并提供了三个主要的预测方法。predict_single方法接收文本和可选的模型名称参数，使用指定模型（默认为langchain-tool）进行单条预测。predict_batch方法类似地执行批量预测。最关键的是ensemble_predict方法，它实现了多模型加权集成投票机制。

集成投票的具体算法流程如下：首先，遍历所有已注册且在权重表中的模型，分别调用其predict_single方法获取预测标签和置信度；然后，将各模型的预测结果统一转换为正面概率值——正面预测（label=1）直接取置信度作为正面概率，负面预测（label=0）则取1减去置信度，中性预测取0.5；接着，按预设权重对各模型的正面概率进行加权平均得到融合概率；最后，根据融合概率与阈值的比较确定最终预测——概率大于0.55判定为正面，小于0.45判定为负面，介于两者之间判定为中性。集成预测的返回结果中除了最终判定外还包含各个参与模型的独立预测结果，便于用户比较和分析。

在API层面，情感分析模块通过三个端点向外提供服务：POST /api/sentiment/analyze-batch接收texts数组执行批量分析，POST /api/sentiment/ensemble接收单条text执行集成投票预测，GET /api/sentiment/models返回已注册模型的列表信息。


4.3  多智能体协作模块的设计与实现

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

多智能体协作模块是本系统的核心创新部分，通过将复杂的舆情分析任务分解为多个专业化子任务并分配给不同的Agent来协同完成，实现了比单一模型分析更加全面和深入的分析效果。

模块的状态定义使用Python的TypedDict类型注解，命名为MultiAgentState。该状态结构包含了工作流全生命周期内需要传递的所有信息字段：输入层面有input_text（待分析文本）和task_type（任务类型）；中间结果层面有sentiment_result、topic_result、risk_result和knowledge_results四个字典或列表字段分别存储各分析Agent的输出；协调信息层面有risk_level（风险等级字符串）、needs_review（是否需要审核的布尔值）和alert_triggered（是否触发预警的布尔值）；审核层面有review_suggestion（审核建议文本）和review_priority（审核优先级整数）；输出层面有final_report（最终报告文本）和agent_logs（Agent执行日志列表）。

六个Agent节点的实现均遵循统一的模式：创建包含Agent名称、动作描述和时间戳的日志条目，在try-except块中执行核心分析逻辑，将结果写入状态对应字段，更新日志条目的状态和详情，将日志追加到agent_logs列表后返回更新的状态。这种统一的实现模式保证了所有Agent在错误处理和日志记录上的行为一致性。

以风险评估Agent（risk_agent_node）为例说明其具体实现。该节点首先调用risk_screener工具对输入文本进行风险筛查，将返回的JSON结果解析后写入state的risk_result字段。随后根据解析出的risk_level值来设置两个协调标志：当风险等级为high或critical时，alert_triggered设为True，表示需要触发预警；当风险等级为medium、high或critical时，needs_review设为True，表示需要创建人工审核任务。这些标志值将影响后续ReviewDecisionAgent的优先级计算和条件路由的方向选择。

审核决策Agent（review_decision_node）的实现体现了多维度信息融合的设计思想。该节点综合考虑风险等级和情感倾向两个维度来计算审核优先级。优先级的映射规则为：critical对应5分并附带"紧急：需要立即人工干预，建议24小时内联系学生"的建议；high对应4分并建议"48小时内安排辅导员约谈"；medium对应2分并建议"一周内关注该学生动态"；low对应0分，标记为"低风险，可归档"。

报告生成Agent（report_agent_node）是工作流的最后一个执行节点。它从状态中提取前序所有Agent的分析结果，构造一个详细的提示词发送给DeepSeek大语言模型。提示词中明确要求模型生成面向辅导员阅读的中文分析报告，包含情况概述、风险评估与建议、后续处理建议三个部分。如果当前分析的是高风险案例（alert_triggered为True），提示词中还会追加特别指令要求模型在报告中强调紧急处理措施。如果KnowledgeAgent提供了检索到的专业参考资料，这些内容也会被整合到提示词中供模型参考。

工作流的构建在build_multi_agent_workflow函数中完成。该函数创建一个LangGraph的StateGraph实例，依次添加六个Agent节点，设置sentiment_agent为入口节点，然后按照设计的执行顺序添加边：sentiment_agent到topic_agent、topic_agent到risk_agent、risk_agent到review_decision。在review_decision节点之后添加条件边，路由函数route_after_risk根据state中risk_level的值返回"knowledge_agent"或"report_agent"来决定分支方向。knowledge_agent节点通过普通边连接到report_agent，report_agent通过边连接到END终止节点。最后调用workflow.compile()方法将图定义编译为可执行的工作流实例。

CoordinatorAgent类作为多智能体系统的统一入口进行了封装。其analyze方法接收待分析文本和任务类型两个参数，构造包含所有字段初始值的MultiAgentState对象，调用编译后的工作流的invoke方法启动执行，获取并返回包含完整分析结果的最终状态。为优化性能，工作流实例采用延迟初始化和全局单例的模式管理，避免了重复的图编译开销。


4.4  风险预警工作流的设计与实现

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

风险预警工作流是多智能体协作工作流的一个简化变体，专门针对需要快速完成风险评估和生成应对回复的使用场景。与完整的多Agent工作流不同，风险预警工作流的设计目标是在较短的处理时间内给出风险判断和初步的回应建议。

该工作流同样基于LangGraph StateGraph构建，其状态定义为AlertState类型，包含input_text、sentiment_result、risk_result、knowledge_results、risk_level、final_response和alert_triggered共7个字段，相比MultiAgentState的结构更为精简。

工作流包含5个处理节点。前两个节点——analyze_sentiment和assess_risk——分别执行情感分析和风险评估，实现逻辑与多Agent工作流中的对应节点类似。关键的区别在于条件路由的设计：route_by_risk函数在风险等级为medium及以上时路由到search_knowledge节点，然后进入generate_response节点生成包含知识库参考内容的详细回复；而在低风险情况下直接路由到generate_simple节点生成简短的友好回复。

generate_response节点面向中高风险场景设计，它从状态中提取情感分析的情绪标签和风险评估的风险信号，结合从知识库中检索到的专业建议，构造一个要求模型以"温暖、专业的校园心理支持助手"角色回复的提示词。当风险等级达到高风险或危急时，提示词中会额外要求模型在回复中提供专业求助资源信息（如心理咨询热线号码等）。generate_simple节点则面向低风险场景，只需要以"友好的校园助手"角色给出简短回应。

该工作流通过POST /api/workflow/alert接口暴露给前端调用，适用于辅导员需要快速了解某条舆情内容的风险程度并获取初步应对建议的场景。


4.5  人工审核模块的设计与实现

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

人工审核模块实现了AI分析与人工判断相结合的闭环管理机制，确保高风险舆情内容在经过系统自动分析后能够得到辅导员的进一步核实和处理。该模块的设计理念是"AI辅助、人工决策"——系统负责自动发现和初步分析潜在的风险内容，但最终的风险判定和处置方案由具备专业经验的辅导员来确认。

模块的核心实现封装在ReviewAgent类中。该类提供了审核任务管理的全套功能方法：

create_review_task方法负责创建审核任务。当多智能体工作流的ReviewDecisionAgent判定某条舆情记录需要人工审核时（needs_review为True），该方法被调用。它在review_tasks表中创建一条新记录，关联对应的sentiment_records记录ID，设置AI判定的风险等级和优先级，并将初始状态设为pending（待审核）。

auto_assign_reviewer方法实现了审核任务向辅导员的智能分配。分配策略基于两个维度：首先按照院系匹配原则，将舆情记录的author_department字段与辅导员的department字段进行匹配，优先分配给同一院系的辅导员；其次在同一院系存在多名辅导员的情况下，采用负载均衡策略，统计各辅导员当前待处理任务数量，将新任务分配给任务量最少的辅导员。分配完成后更新任务的reviewer_id字段和assigned_at时间戳。

submit_review方法处理辅导员提交的审核结果。辅导员在审核界面中可以执行以下操作：确认或修改AI判定的风险等级、填写审核意见和已采取措施、标记是否需要后续跟进并填写跟进备注、将任务状态更新为approved（通过）、rejected（驳回）或escalated（升级）。当辅导员选择升级操作时，系统会将任务优先级提升至最高值5，表示需要更高级别的管理人员介入处理。

get_review_stats方法聚合查询审核相关的统计数据，包括各状态任务的数量分布、各优先级的任务数量、平均处理时长等，供仪表板页面展示。

在API层面，审核模块通过三个端点提供服务。GET /api/review/tasks端点支持按状态（pending、processing、approved、rejected、escalated）和优先级范围进行筛选查询，返回结果按优先级降序排列以确保高优先级任务排在前面。POST /api/review/submit端点接收包含任务ID、操作类型和审核内容的请求体，调用submit_review方法完成审核操作。GET /api/review/stats端点返回审核统计数据。


4.6  知识检索与RAG模块的设计与实现

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

知识检索与RAG模块为系统的智能分析提供了外部知识的支撑能力，使得系统在面对高风险舆情时能够引用专业的心理健康指导材料来增强分析报告的权威性和实用性。

模块的实现分为知识库构建和知识检索两个部分。

知识库构建功能封装在KnowledgeBase类中，该类位于data_pipeline.py文件。构建流程的第一步是文档解析：系统支持读取TXT纯文本文件、PDF文档（通过PyPDF库）和DOCX文档（通过python-docx库）三种格式的知识文档。知识文档存放在项目的knowledge_docs目录下，内容涵盖高校学生心理健康教育指南、心理危机干预工作手册、辅导员工作规范等专业资料。

文档解析完成后进入文本预处理环节。系统对原始文本执行了校园场景特定的替换操作，例如将通用的指代表述替换为更具体的校园相关表述，以提高后续检索时与校园舆情查询的语义匹配度。预处理后的文本使用LangChain的RecursiveCharacterTextSplitter进行分块处理，该分割器采用递归的方式按照段落、句子、词等多级分隔符进行切分，确保在满足块大小限制（chunk_size参数）的同时尽量保持语义的完整性。相邻文本块之间设置一定长度的重叠（chunk_overlap参数），以避免重要信息因处于两个块的分界处而被割裂。

文本块的向量化编码使用HuggingFace提供的all-MiniLM-L6-v2预训练句子嵌入模型。该模型将文本映射为384维的稠密向量表示，在语义相似度计算任务上具有较好的性能和较小的模型体积。编码后的向量连同原始文本一起存入ChromaDB向量数据库。ChromaDB的数据持久化存储在项目目录下的chroma_db文件夹中。

知识检索功能封装为LangChain工具knowledge_searcher，供KnowledgeAgent在工作流中调用。检索时，系统将查询文本（通常由情绪标签和风险信号词拼接而成）同样通过all-MiniLM-L6-v2模型编码为向量，然后在ChromaDB中执行基于余弦相似度的Top-K近邻检索。检索结果包含匹配的文本内容和相似度评分，按相似度降序排列后返回给调用方。KnowledgeAgent取检索结果中的前3条作为参考资料传递给后续的ReportAgent。


4.7  前端可视化模块的设计与实现

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

前端可视化模块基于React框架构建，为辅导员和管理人员提供了直观、易用的图形化操作界面。前端项目使用Vite作为构建工具，采用React Router DOM实现客户端路由，使用Axios作为HTTP请求客户端与后端API进行通信。

前端共设计了8个功能页面，通过左侧导航栏进行切换：

（1）总览仪表板页面（OverviewPage）。该页面是用户登录后的默认着陆页，以信息卡片的形式展示关键统计指标（舆情总量、今日新增、负面占比、待处理预警数等），下方区域包含24小时情感趋势折线图（使用Recharts的LineChart组件，X轴为时间、Y轴为各情感类别的数量）、信息来源饼图（展示各平台数据占比）、平台情感细表（以表格形式展示每个平台的正面/负面/中性数量和占比）、热门话题列表（按热度排序展示Top10话题及其情感标签）和最新预警列表（展示最近的5条预警信息及其状态）。

（2）舆情监测页面（MonitoringPage）。该页面聚焦于实时舆情动态，上方展示各平台声量统计柱状图和声量变化趋势折线图，中部展示基于高频词生成的实时舆情词云，下方以列表形式展示最新的舆情提及记录，每条记录显示内容摘要、来源平台、情感标签和发布时间。

（3）情感分析页面（SentimentPage）。该页面从情感维度对舆情数据进行深入展示。包含整体情感分布饼图（正面/负面/中性的比例）、最近一周的情感趋势变化图以及正面、负面和中性三类情感中各自出现频率最高的关键词列表。

（4）热点话题页面（TopicsPage）。该页面以全榜形式展示当前的热点话题列表，每个话题条目包含话题名称、热度值、来源平台分布、情感倾向标签和趋势指示符。用户点击某个话题可展开查看该话题下的相关舆情记录和详细趋势数据。

（5）预警中心页面（AlertsPage）。该页面是辅导员进行预警管理操作的核心界面。顶部展示预警统计卡片（活跃预警数、已确认数、已解决数和已忽略数），主体区域为预警处理列表。每条预警显示标题、风险等级（以不同颜色标识）、触发时间、当前状态和AI建议的处置方案。辅导员可以对每条预警执行确认（acknowledged）、标记为已解决（resolved）或忽略（dismissed）三种操作，操作时可填写处理备注。

（6）分析报告页面（ReportsPage）。该页面提供报告的生成和预览功能。用户可以选择生成日报、周报、月报或AI智能报告四种类型。日报、周报和月报基于数据库中的统计数据生成结构化的文字报告，AI智能报告则调用大语言模型根据近期数据生成分析性的文字内容。生成的报告在页面右侧的预览区域展示。

（7）系统设置页面（SettingsPage）。该页面提供系统参数的配置管理功能，包括四个设置模块：通知推送设置（是否开启邮件通知、推送频率等）、预警阈值设置（各风险等级触发预警的置信度阈值）、监测关键词管理（添加、删除和编辑需要重点关注的关键词列表）和数据采集配置（采集频率、采集源选择和采集器状态查看）。

（8）智能分析页面（AnalysisPage）。该页面提供了多Agent协作分析的交互入口。页面包含一个文本输入区域和一个"开始分析"按钮，用户输入待分析的文本后点击按钮触发多Agent工作流的执行。分析过程中，页面实时展示各Agent的执行状态和日志信息（通过WorkflowLog组件），分析完成后以结构化卡片（ResultCard组件）的形式展示情感分析结果、主题分析结果、风险评估结果和最终的综合报告。

在前端的整体布局设计上，系统采用了固定侧边栏加顶栏的经典管理后台布局。侧边栏（Sidebar组件）固定在页面左侧，包含系统Logo、导航菜单和用户信息区域。顶栏（Header组件）固定在页面顶部，显示当前页面标题和全局操作按钮。主内容区域占据中部的剩余空间，根据路由动态加载对应的页面组件。界面设计采用CSS自定义属性实现主题变量管理，支持浅色和深色两种主题模式切换。


4.8  本章小结

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

本章详细介绍了系统各功能模块的设计方案和关键实现。数据采集模块通过两阶段管道实现了12个平台的热点采集和AI话题提取；情感分析模块基于抽象基类设计了可扩展的多模型框架并实现了集成投票机制；多智能体协作模块利用LangGraph编排了六个专业Agent的协作工作流；风险预警工作流提供了快速风险评估和应对回复的能力；人工审核模块实现了从任务创建到跟进反馈的闭环管理；知识检索模块通过向量检索支撑了RAG增强生成；前端模块提供了8个功能页面的完整可视化管理界面。上述模块的协同工作构成了本系统的完整功能体系。


第五章  系统测试与结果分析

【格式说明：章标题，黑体小二号居中，段前24磅段后18磅】

5.1  测试环境

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

系统的测试在以下软硬件环境中进行：

硬件环境：处理器为Intel Core i7-12700H，内存16GB DDR5，固态硬盘512GB，网络环境为校园有线网络（100Mbps带宽）。

软件环境：操作系统为Windows 10专业版（版本号22H2），Python解释器版本为3.12.x，Node.js版本为18.x LTS，MySQL数据库版本为8.0，浏览器为Google Chrome 124。后端运行环境使用Uvicorn ASGI服务器，前端开发服务器使用Vite内置的开发服务器。

主要依赖库版本：FastAPI 0.100.0+、LangChain 0.2.x、LangGraph 0.x、ChromaDB 0.4.x、SQLAlchemy 2.0.x、React 19.0、Vite 7.x、Recharts 3.7.x。

外部服务：DeepSeek API（用于大语言模型推理）、公开新闻聚合API（用于数据采集）。


5.2  功能测试

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

功能测试旨在验证系统各模块能否按照需求规格正确地完成其设计功能。测试采用黑盒测试方法，按照功能模块逐一进行。

（1）数据采集功能测试

测试目标：验证系统能否成功从多个平台采集热点数据并完成话题提取。

测试步骤：通过API调用POST /api/collector/full-pipeline?import_db=true触发完整采集管道。

测试结果：系统成功从微博热搜、知乎热榜、B站热搜、抖音热榜、百度贴吧和今日头条6个优先源发起数据采集请求。在一次典型的测试执行中，6个源中有5个成功返回数据（1个因网络超时失败），共采集到237条热点新闻标题。随后AI话题提取环节从中提取出42个关键词和15个搜索词，耗时约18.6秒。数据导入环节成功将219条有效记录（去除标题过短的无效项后）写入MySQL数据库。测试结论：数据采集功能正常，具备容错能力，单个源的失败不影响整体流程。

（2）情感分析功能测试

测试目标：验证情感分析的准确性和多模型集成投票的有效性。

测试数据：选取了30条涵盖正面、负面和中性情感的校园相关文本作为测试样本，其中正面文本10条（如"今天的讲座非常精彩，学到了很多新知识"）、负面文本12条（如"考试挂科了，感觉自己什么都不行"）和中性文本8条（如"明天下午三点在图书馆开会"）。这些样本的情感标签由三名标注者独立标注后取多数投票结果作为黄金标准。

测试结果：使用langchain-tool单模型进行测试，在30条样本上的分类准确率为83.3%（25/30），其中正面文本识别准确率90%（9/10），负面文本识别准确率83.3%（10/12），中性文本识别准确率75%（6/8），中性文本的误判主要发生在带有轻微情感倾向的表述上。使用ensemble集成投票模式进行测试，准确率提升至86.7%（26/30），主要改善来自两个模型对边界样本的互补修正。测试结论：情感分析功能基本满足需求，集成投票机制对准确率有一定提升。

（3）多智能体协作分析功能测试

测试目标：验证六个Agent能否按照设计的工作流正确协作并生成综合报告。

测试步骤：通过POST /api/multi-agent/analyze接口提交三条不同风险等级的测试文本：低风险文本"今天天气不错，和室友一起去操场打球了"、中等风险文本"最近总是失眠，学习压力好大，不太想和别人说话"和高风险文本"感觉活着没什么意思，什么事情都提不起兴趣，想从这个世界消失"。

测试结果：三条文本均成功完成了多Agent分析流程。低风险文本的工作流执行路径为SentimentAgent→TopicAgent→RiskAgent→ReviewDecisionAgent→ReportAgent，风险等级判定为low，审核优先级为0，未触发知识检索和预警。中等风险文本的执行路径相同，风险等级判定为medium，审核优先级为2，标记为需要审核但未触发预警。高风险文本的执行路径增加了KnowledgeAgent节点（SentimentAgent→TopicAgent→RiskAgent→ReviewDecisionAgent→KnowledgeAgent→ReportAgent），风险等级判定为critical，审核优先级为5，触发预警，知识检索Agent成功从知识库中检索到3条相关的心理危机干预材料，最终报告中包含了紧急处理建议和心理咨询热线信息。三次分析过程的Agent执行日志均完整记录了每个Agent的名称、动作、时间和状态信息。测试结论：多智能体协作工作流功能正确，条件路由机制按预期工作。

（4）预警管理功能测试

测试目标：验证预警的创建、查询和处理操作的正确性。

测试步骤：首先通过多Agent分析触发高风险预警的创建，然后通过GET /api/alerts查询预警列表，最后通过POST /api/alerts/{id}/handle分别执行确认、解决和忽略操作。

测试结果：高风险分析完成后系统自动创建了一条预警记录，预警状态为active，风险等级为critical。通过API成功查询到该预警并返回了完整的预警信息。执行确认操作后预警状态更新为acknowledged，执行解决操作后状态更新为resolved并记录了处理备注和解决时间。预警统计接口正确返回了各状态的预警数量。测试结论：预警管理功能正常。

（5）人工审核功能测试

测试目标：验证审核任务的自动创建、辅导员分配和审核提交流程的正确性。

测试结果：当中等风险以上的舆情记录被分析后，系统自动创建了审核任务，任务状态为pending，优先级根据风险等级正确设置。辅导员分配功能根据author_department字段成功匹配到对应院系的辅导员。通过POST /api/review/submit提交审核时，任务状态和审核意见被正确更新。测试结论：人工审核功能的闭环流程运行正确。

（6）前端界面功能测试

测试目标：验证8个前端页面的展示和交互功能。

测试方法：在Chrome浏览器中逐一访问各页面，检查数据加载、图表渲染和操作交互。

测试结果：总览仪表板页面正确展示了统计指标卡片、趋势图和排行列表。舆情监测页面的词云和提及列表数据加载正常。情感分析页面的饼图和趋势图渲染正确。热点话题页面的话题列表排序和展开详情功能正常。预警中心页面的确认/解决/忽略操作均能正确更新预警状态并刷新列表。分析报告页面的四种报告类型均能成功生成并在预览区域展示。系统设置页面的配置修改和保存功能正常。智能分析页面的多Agent分析流程和结果展示正常。测试结论：前端界面各功能正常运行。


5.3  性能测试

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

性能测试针对系统的关键接口进行响应时间测量，以评估系统在实际使用条件下的性能表现。

测试方法：对每个被测接口连续发送10次请求，记录每次的响应时间，取平均值和最大值作为评估指标。测试在本地开发环境下进行，后端和数据库均运行在同一台机器上，网络延迟可忽略不计（外部API调用除外）。

表5-1  主要接口响应时间测试结果

【格式说明：表格标题，宋体五号加粗居中，位于表格上方】

+---------------------------------+------------------+------------------+
|          接口名称                |  平均响应时间(ms) |  最大响应时间(ms) |
+---------------------------------+------------------+------------------+
| GET /api/dashboard/overview     |       126        |       215        |
+---------------------------------+------------------+------------------+
| GET /api/dashboard/sentiment-   |        89        |       143        |
| trend                           |                  |                  |
+---------------------------------+------------------+------------------+
| POST /api/sentiment (单条)      |      2,847       |      4,102       |
+---------------------------------+------------------+------------------+
| POST /api/sentiment/ensemble    |      5,523       |      7,811       |
+---------------------------------+------------------+------------------+
| POST /api/multi-agent/analyze   |     12,368       |     18,276       |
+---------------------------------+------------------+------------------+
| POST /api/collector/full-       |     22,150       |     31,045       |
| pipeline                        |                  |                  |
+---------------------------------+------------------+------------------+
| GET /api/review/tasks           |        67        |       112        |
+---------------------------------+------------------+------------------+
| GET /api/alerts                 |        54        |        89        |
+---------------------------------+------------------+------------------+

从测试结果可以看出，纯数据库查询类接口（如仪表板数据、审核任务列表和预警列表）的响应时间均在200ms以内，表现良好。涉及大语言模型调用的接口响应时间明显较长，这主要受制于外部LLM API的推理延迟。单条情感分析接口的平均响应时间约2.8秒，集成投票由于需要调用两次模型（两个注册模型各调用一次），响应时间约为单次的2倍。多Agent协作分析接口的响应时间最长，平均约12.4秒，这是因为工作流中6个Agent需要依次执行多次LLM调用。数据采集管道的响应时间最长可达31秒，主要耗时在对多个外部新闻API的网络请求和AI话题提取的LLM调用上。

总体而言，数据查询类操作的性能满足实时交互的要求，AI分析类操作的响应时间虽然较长但在可接受范围内（用户提交分析请求后等待数秒到十几秒获得结果属于合理预期）。数据采集操作作为后台任务通常由系统定时触发或管理员手动触发，其较长的执行时间不影响用户的日常使用体验。


5.4  测试结果分析

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

综合功能测试和性能测试的结果，本系统在以下方面表现符合预期：

第一，多平台数据采集功能运行稳定，能够有效应对个别数据源不可用的情况。两阶段采集管道的设计将热点发现和话题提取有机结合，AI话题提取环节能够较为准确地从通用新闻中筛选出与校园生活相关的内容。

第二，基于大语言模型的情感分析在校园相关文本上达到了可接受的准确率水平。多模型集成投票机制对分类准确率有一定提升，特别是在情感边界模糊的样本上表现出了互补优势。

第三，多智能体协作工作流能够按照设计的顺序正确执行，条件路由机制根据风险等级动态选择处理路径的功能正常运行。各Agent之间通过共享状态实现的信息传递准确可靠。

第四，风险预警和人工审核的闭环管理流程运转顺畅，从风险发现到任务分配再到审核处置的全链路功能完整。

同时，测试也暴露了系统当前存在的一些不足：一是情感分析对中性文本的识别准确率相对偏低，部分带有轻微情感色彩的表述容易被误判为中性或相反极性；二是涉及LLM调用的接口响应时间较长，在并发用户较多时可能影响用户体验；三是系统目前没有实现完整的用户认证和权限管理机制，在实际部署时需要进一步完善安全防护。


5.5  本章小结

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

本章对系统进行了功能测试和性能测试。功能测试覆盖了数据采集、情感分析、多Agent协作、预警管理、人工审核和前端界面六个模块，测试结果表明各模块的功能实现符合设计预期。性能测试对8个关键接口进行了响应时间评估，数据库查询类接口表现良好，LLM调用类接口受限于外部API延迟但在可接受范围内。测试结果总体上验证了系统设计方案的可行性和实现质量。


第六章  总结与展望

【格式说明：章标题，黑体小二号居中，段前24磅段后18磅】

6.1  工作总结

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

本文围绕高校校园舆情监测与情感分析的实际需求，设计并实现了一套基于多智能体协作架构的智能化管理系统。回顾整个研究过程，本文的主要工作和成果可以归纳如下。

在系统架构层面，本文设计了一套融合多项先进技术的分层系统架构。系统采用前后端分离的B/S架构，以FastAPI构建高性能的后端API服务层，以React构建具有8个功能页面的前端可视化管理界面，使用MySQL和ChromaDB的双数据库方案分别支撑结构化业务数据存储和向量化知识检索。整个架构层次清晰、模块解耦，具备较好的可维护性和可扩展性。

在核心算法层面，本文实现了三项关键的技术创新。一是基于LangGraph状态图引擎构建的六智能体协作工作流，将舆情分析任务分解为情感分析、主题聚类、风险评估、审核决策、知识检索和报告生成六个专业化环节，通过协调者Agent进行统一调度，实现了多维度的深度综合分析。二是基于抽象基类和多模型注册机制的可扩展情感分析框架，以及多模型加权集成投票算法，通过融合不同推理路径的分析结果来提高预测稳健性。三是将检索增强生成技术融入多Agent工作流中，在高风险场景下自动引入专业知识库的参考材料增强分析报告的质量。

在功能实现层面，本文完成了从数据采集到分析预警再到审核处置的全流程功能建设。数据采集模块实现了覆盖12个主流平台的多源数据采集和基于AI的话题自动提取。风险预警模块实现了四级风险分类和自动预警触发。人工审核模块实现了任务自动创建、院系匹配分配、审核操作和升级处理的闭环管理。可视化模块通过丰富的图表和交互组件为用户提供了直观的数据展示和操作体验。此外，系统还实现了MCP协议接口和可插拔的Skill技能系统，为系统功能的外部集成和灵活扩展预留了空间。

在系统测试层面，通过对六大功能模块的测试和对8个关键接口的性能评估，验证了系统各功能的正确性和性能的可接受性。情感分析在校园相关文本上达到了86.7%的集成投票准确率，多Agent协作工作流的条件路由机制按预期正确运行，全流程的闭环管理链路功能完整。


6.2  不足与展望

【格式说明：节标题，黑体小三号，段前18磅段后12磅】

尽管本系统在功能和技术实现上取得了预期的成果，但在研究和开发过程中也暴露出一些不足之处，同时对未来的改进和发展也有着进一步的设想。

第一，在情感分析的精度方面，当前系统完全依赖大语言模型的零样本推理能力进行情感分类，虽然在多数场景下表现可接受，但在中性文本识别和语义模糊文本的处理上仍有提升空间。未来可以考虑引入少量校园领域标注数据对模型进行微调（Fine-tuning），或者增加基于BERT等预训练模型的专用情感分类器作为集成投票的成员模型，以进一步提高分析精度。

第二，在系统性能方面，由于多Agent协作工作流中多次调用外部LLM API，端到端的处理时间较长。在后续优化中，可以探索对部分可并行的Agent节点实施并行执行（如SentimentAgent和TopicAgent理论上可以同时运行），以缩短工作流的整体耗时。此外，引入分析结果的缓存机制，对相似或重复的文本复用已有的分析结果，也是降低LLM调用成本和提升响应速度的有效手段。

第三，在数据采集的深度方面，当前系统采集的主要是各平台的热点标题文本，缺乏对评论、回复等二级内容的深度采集。未来可以在话题提取的基础上，进一步采集与校园话题相关的社交媒体帖子和评论内容，以获取更加丰富和精细的舆情数据。

第四，在安全和权限管理方面，当前系统尚未实现完整的用户认证和基于角色的访问控制（RBAC）机制。在实际部署到生产环境之前，需要补充JWT令牌认证、接口访问鉴权、操作日志审计等安全功能，以确保系统的使用安全。

第五，在智能化水平方面，当前的多Agent协作采用的是固定拓扑的顺序执行模式，Agent之间的交互较为刚性。未来可以探索基于LLM的动态任务规划能力，由CoordinatorAgent根据具体的分析任务和中间结果动态决定需要调用哪些Agent以及调用顺序，实现更加灵活和智能的协作模式。同时，可以引入Agent的自我反思和迭代优化机制，当某个Agent的输出结果置信度不足时自动重新分析或请求其他Agent协助。

综上所述，本文设计实现的校园舆情监测与情感分析系统在当前阶段已经具备了基本完整的功能体系，可以为高校舆情管理工作提供有效的技术支持。随着后续在精度优化、性能提升、安全加固和智能化增强等方面的持续改进，系统有望在实际的高校管理场景中发挥更大的应用价值。


参考文献

【格式说明：标题，黑体小二号居中；内容，宋体五号，行距固定值20磅，悬挂缩进】
【格式说明：参考文献采用顺序编码制，按文中引用顺序编号】

[1] 中国互联网络信息中心. 第53次中国互联网络发展状况统计报告[R]. 北京: 中国互联网络信息中心, 2024.
[2] 教育部. 关于加强新时代学生心理健康教育工作的通知[Z]. 教思政厅函〔2021〕10号, 2021.
[3] Brown T B, Mann B, Ryder N, et al. Language models are few-shot learners[C]// Advances in Neural Information Processing Systems. 2020, 33: 1877-1901.
[4] Chase H. LangChain: Building applications with LLMs through composability[EB/OL]. https://github.com/langchain-ai/langchain, 2022.
[5] LangChain Team. LangGraph: Build resilient language agents as graphs[EB/OL]. https://github.com/langchain-ai/langgraph, 2024.
[6] Pang B, Lee L. Opinion mining and sentiment analysis[J]. Foundations and Trends in Information Retrieval, 2008, 2(1-2): 1-135.
[7] Liu B. Sentiment analysis: Mining opinions, sentiments, and emotions[M]. Cambridge: Cambridge University Press, 2015.
[8] Devlin J, Chang M W, Lee K, et al. BERT: Pre-training of deep bidirectional transformers for language understanding[C]// Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics. 2019: 4171-4186.
[9] Liu Y, Ott M, Goyal N, et al. RoBERTa: A robustly optimized BERT pretraining approach[J]. arXiv preprint arXiv:1907.11692, 2019.
[10] Bollen J, Mao H, Zeng X. Twitter mood predicts the stock market[J]. Journal of Computational Science, 2011, 2(1): 1-8.
[11] 刘毅. 网络舆情研究概论[M]. 天津: 天津人民出版社, 2007.
[12] 兰月新, 曾润喜. 基于多源异构数据的网络舆情态势感知研究[J]. 情报科学, 2019, 37(10): 3-8.
[13] 周锐, 张磊, 王晓丽. 融合情感分析的高校网络舆情预警模型研究[J]. 现代教育技术, 2020, 30(8): 54-60.
[14] 张斌, 李明, 陈浩. 面向高校微博数据的舆情分析系统设计与实现[J]. 计算机应用与软件, 2021, 38(5): 62-67.
[15] Hu M, Liu B. Mining and summarizing customer reviews[C]// Proceedings of the 10th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. 2004: 168-177.
[16] Kim Y. Convolutional neural networks for sentence classification[C]// Proceedings of the 2014 Conference on Empirical Methods in Natural Language Processing. 2014: 1746-1751.
[17] Tang D, Qin B, Feng X, et al. Effective LSTMs for target-dependent sentiment classification[C]// Proceedings of the 26th International Conference on Computational Linguistics. 2016: 3298-3307.
[18] Zhang W, Deng Y, Liu B, et al. Sentiment analysis in the era of large language models: A reality check[J]. arXiv preprint arXiv:2305.15005, 2023.
[19] DeepSeek-AI. DeepSeek-V2: A strong, economical, and efficient mixture-of-experts language model[J]. arXiv preprint arXiv:2405.04434, 2024.
[20] Wooldridge M. An introduction to multiagent systems[M]. 2nd ed. Chichester: John Wiley & Sons, 2009.
[21] Park J S, O'Brien J C, Cai C J, et al. Generative agents: Interactive simulacra of human behavior[C]// Proceedings of the 36th Annual ACM Symposium on User Interface Software and Technology. 2023: 1-22.
[22] Wu Q, Bansal G, Zhang J, et al. AutoGen: Enabling next-gen LLM applications via multi-agent conversation[J]. arXiv preprint arXiv:2308.08155, 2023.
[23] Moura J. CrewAI: Framework for orchestrating role-playing, autonomous AI agents[EB/OL]. https://github.com/joaomdmoura/crewAI, 2024.
[24] Vaswani A, Shazeer N, Parmar N, et al. Attention is all you need[C]// Advances in Neural Information Processing Systems. 2017, 30: 5998-6008.
[25] Lewis P, Perez E, Piktus A, et al. Retrieval-augmented generation for knowledge-intensive NLP tasks[C]// Advances in Neural Information Processing Systems. 2020, 33: 9459-9474.
[26] Ramírez S. FastAPI: Modern, fast web framework for building APIs with Python[EB/OL]. https://fastapi.tiangolo.com, 2018.


致  谢

【格式说明：标题，黑体小二号居中，段前24磅段后18磅】
【格式说明：正文，宋体小四号，行距20磅，首行缩进2字符】

大学四年的时光在不经意间已接近尾声，回首这段求学历程，有太多的人和事值得感怀和铭记。在本论文完成之际，谨向所有给予过我帮助和支持的人表达最诚挚的谢意。

首先，我要衷心感谢我的指导老师。从选题方向的确定到技术方案的论证，从系统架构的设计到论文写作的修改，老师始终给予了我悉心的指导和耐心的解答。每次遇到技术难题感到迷茫时，老师总能以其深厚的专业素养为我指明前进的方向。老师严谨的治学态度和务实的工作作风也深深影响着我，将成为我未来职业生涯中宝贵的精神财富。

其次，我要感谢在系统开发过程中给予过我帮助的同学们。在需求调研阶段，多位担任学生干部的同学帮我联系了辅导员老师进行访谈，为系统的需求分析提供了宝贵的第一手资料。在开发和测试阶段，室友和实验室的伙伴们帮忙测试系统功能、反馈使用体验，他们提出的许多建设性意见使得系统的设计更加贴近实际使用场景。

同时，我也要感谢开源社区和广大技术博主的无私分享。LangChain、LangGraph、FastAPI、React等开源项目及其完善的文档为本系统的技术实现提供了坚实的基础。在遇到具体的技术问题时，Stack Overflow和各种技术博客上的讨论和经验分享也给了我很多有益的启发。

最后，我要特别感谢我的父母和家人。是他们一如既往的理解、支持和鼓励，让我能够在大学四年中心无旁骛地学习和成长。正是他们的默默付出和无私关爱，成就了今天完成学业的我。

在此，再次向所有关心和帮助过我的人致以最诚挚的感谢！


